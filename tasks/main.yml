---
# fix_empty_etc_resolv_conf/tasks/main.yml

- name: "Check resolv.conf for wrong entries"
  shell: "cat /etc/resolv.conf"
  register: cat_resolv_conf
  check_mode: false
  changed_when: false

- name: "Remove empty /etc/resolv.conf"
  file:
    path: "/etc/resolv.conf"
    state: "absent"
  when: cat_resolv_conf.stdout.find("; Created by cloud-init on instance boot automatically, do not edit.") != -1
  notify:
    - "restart network service"
